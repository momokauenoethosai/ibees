# Vision RAG Tools

ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã¯ã€é¡”åˆæˆã‚·ã‚¹ãƒ†ãƒ ã®ãƒ†ã‚¹ãƒˆãƒ»é–‹ç™ºãƒ„ãƒ¼ãƒ«ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

## ğŸ§° ä¸»è¦ãƒ„ãƒ¼ãƒ«

### 1. **iterative_face_refiner.py** 
**é¡”é¡ä¼¼åº¦ãƒ™ãƒ¼ã‚¹ã®åå¾©èª¿æ•´ã‚·ã‚¹ãƒ†ãƒ ï¼ˆãƒ¡ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«ï¼‰**

```bash
# åŸºæœ¬ä½¿ç”¨æ³•
python tools/iterative_face_refiner.py outputs/run_20250830_164634.json

# åå¾©å›æ•°æŒ‡å®š
python tools/iterative_face_refiner.py outputs/run_20250830_164634.json 3
```

**æ©Ÿèƒ½:**
- å…ƒã®é¡”å†™çœŸã¨åˆæˆç”»åƒã‚’æ¯”è¼ƒåˆ†æ
- Geminiã«ã‚ˆã‚‹æ®µéšçš„ãƒ‘ãƒ¼ãƒ„ä½ç½®ãƒ»ã‚µã‚¤ã‚ºèª¿æ•´
- èª¿æ•´å±¥æ­´ã®è¿½è·¡ã¨æ´»ç”¨
- é¡ä¼¼åº¦ã‚¹ã‚³ã‚¢ã«ã‚ˆã‚‹åæŸåˆ¤å®š

**å‡ºåŠ›:**
- `outputs/similarity_iter_*.png` - å„åå¾©ã®åˆæˆçµæœ
- `outputs/comparison_*.png` - å…ƒç”»åƒvsåˆæˆç”»åƒã®æ¯”è¼ƒ

### 2. **test_with_grid_overlay.py**
**ã‚°ãƒªãƒƒãƒ‰ä»˜ãåˆæˆãƒ†ã‚¹ãƒˆï¼ˆåº§æ¨™ç¢ºèªç”¨ï¼‰**

```bash
# åŸºæœ¬ä½¿ç”¨æ³•  
python tools/test_with_grid_overlay.py outputs/run_20250830_164634.json

# å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«åæŒ‡å®š
python tools/test_with_grid_overlay.py outputs/run_20250830_164634.json grid_result.png
```

**æ©Ÿèƒ½:**
- JSONã®åˆ†æçµæœã‹ã‚‰åˆæˆç”»åƒã‚’ç”Ÿæˆ
- åº§æ¨™ç¢ºèªç”¨ã®ã‚°ãƒªãƒƒãƒ‰ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤
- ãƒ‘ãƒ¼ãƒ„é…ç½®ã®è¦–è¦šçš„æ¤œè¨¼

### 3. **create_debug_grid.py**
**ãƒ‡ãƒãƒƒã‚°ç”¨ã‚°ãƒªãƒƒãƒ‰ç”»åƒä½œæˆ**

```bash
python tools/create_debug_grid.py
```

**æ©Ÿèƒ½:**
- åº§æ¨™ç³»ç†è§£ç”¨ã®ã‚°ãƒªãƒƒãƒ‰ç”»åƒç”Ÿæˆ
- é–‹ç™ºãƒ»ãƒ‡ãƒãƒƒã‚°æ™‚ã®åº§æ¨™ç¢ºèª

### 4. **test_face_composition.py** 
**é¡”åˆæˆæ©Ÿèƒ½ã®åŸºæœ¬ãƒ†ã‚¹ãƒˆ**

```bash
python tools/test_face_composition.py
```

**æ©Ÿèƒ½:**
- FaceComposerã®åŸºæœ¬å‹•ä½œç¢ºèª
- ãƒ‘ãƒ¼ãƒ„é…ç½®ãƒ†ã‚¹ãƒˆ

## ğŸ“ ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

### é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆæ‰‹é †

1. **åˆæœŸåˆ†æ**: Webã‚¢ãƒ—ãƒªã§ç”»åƒåˆ†æ â†’ JSONç”Ÿæˆ
2. **åº§æ¨™ç¢ºèª**: `test_with_grid_overlay.py` ã§ãƒ‘ãƒ¼ãƒ„é…ç½®ç¢ºèª
3. **åå¾©èª¿æ•´**: `iterative_face_refiner.py` ã§å…ƒç”»åƒé¡ä¼¼åº¦å‘ä¸Š
4. **çµæœæ¤œè¨¼**: ç”Ÿæˆã•ã‚ŒãŸæ¯”è¼ƒç”»åƒã§åŠ¹æœç¢ºèª

### ãƒ•ã‚¡ã‚¤ãƒ«å‘½åè¦å‰‡

- `run_*.json` - åˆ†æçµæœJSON
- `composed_*.png` - åŸºæœ¬åˆæˆç”»åƒ
- `similarity_iter_*.png` - åå¾©èª¿æ•´çµæœ
- `comparison_*.png` - å…ƒç”»åƒvsåˆæˆç”»åƒæ¯”è¼ƒ
- `grid_*.png` - ã‚°ãƒªãƒƒãƒ‰ä»˜ãæ¤œè¨¼ç”»åƒ

## âš™ï¸ è¨­å®š

### APIè¨­å®š
- **Gemini API**: `gemini-2.5-pro` (é«˜ç²¾åº¦ãƒ¢ãƒ‡ãƒ«)
- **Canvas Size**: 400x400px
- **æœ€å¤§åå¾©å›æ•°**: 5å›ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰

### èª¿æ•´ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
```python
ADJUSTMENT_STEPS = {
    'position': {
        'up/down/left/right': 5pxç§»å‹•,
        'up_slight/down_slight/left_slight/right_slight': 3pxç§»å‹•
    },
    'scale': {
        'bigger/smaller': 0.05å€å¤‰æ›´,
        'bigger_slight/smaller_slight': 0.03å€å¤‰æ›´
    }
}
```

## ğŸ¯ æœ€é©ãªä½¿ç”¨æ³•

1. **é«˜ç²¾åº¦èª¿æ•´**: `iterative_face_refiner.py` - å…ƒç”»åƒã¨ã®é¡ä¼¼åº¦å‘ä¸Š
2. **åº§æ¨™ãƒ‡ãƒãƒƒã‚°**: `test_with_grid_overlay.py` - ãƒ‘ãƒ¼ãƒ„é…ç½®ç¢ºèª  
3. **åŸºæœ¬å‹•ä½œç¢ºèª**: `test_face_composition.py` - ã‚·ã‚¹ãƒ†ãƒ å‹•ä½œæ¤œè¨¼